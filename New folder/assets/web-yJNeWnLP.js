const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-C1oCeIjs.js","assets/index-B8csNmOU.js","assets/index-B4jCrMlM.css"])))=>i.map(i=>d[i]);
import{r as ve,_ as Re,C as ye,g as Ee,W as _e}from"./index-B8csNmOU.js";const F={RECORDING:"RECORDING",PAUSED:"PAUSED",NONE:"NONE"};function be(i){i.CapacitorUtils.Synapse=new Proxy({},{get(o,a){return new Proxy({},{get(p,d){return(l,c,f)=>{const s=i.Capacitor.Plugins[a];if(s===void 0){f(new Error(`Capacitor plugin ${a} not found`));return}if(typeof s[d]!="function"){f(new Error(`Method ${d} not found in Capacitor plugin ${a}`));return}(async()=>{try{const v=await s[d](l);c(v)}catch(v){f(v)}})()}}})}})}function Se(i){i.CapacitorUtils.Synapse=new Proxy({},{get(o,a){return i.cordova.plugins[a]}})}function Pe(i=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!i?be(window):window.cordova!==void 0&&Se(window))}var ne;(function(i){i.Documents="DOCUMENTS",i.Data="DATA",i.Library="LIBRARY",i.Cache="CACHE",i.External="EXTERNAL",i.ExternalStorage="EXTERNAL_STORAGE",i.ExternalCache="EXTERNAL_CACHE",i.LibraryNoCloud="LIBRARY_NO_CLOUD",i.Temporary="TEMPORARY"})(ne||(ne={}));var oe;(function(i){i.UTF8="utf8",i.ASCII="ascii",i.UTF16="utf16"})(oe||(oe={}));const k=ve("Filesystem",{web:()=>Re(()=>import("./web-C1oCeIjs.js"),__vite__mapDeps([0,1,2])).then(i=>new i.FilesystemWeb)});Pe();const Te=ve("BlobWriter");function Oe(i){return window.btoa(Array.from(new Uint8Array(i)).map(function(o){return String.fromCharCode(o)}).join(""))}function Ne({path:i,directory:o,blob:a,recursive:p}){return k.writeFile({directory:o,path:i,recursive:p,data:""}).then(function(){return new Promise(function(d,l){function c(s){l(s.target.error)}const f=window.indexedDB.open("Disc");f.onerror=c,f.onsuccess=function(){const v=f.result.transaction("FileStorage","readwrite");v.onerror=c;const g=v.objectStore("FileStorage"),m=`/${o}/${i.replace(/^\//,"")}`,_=g.get(m);_.onsuccess=function(){_.result.size=a.size,_.result.content=a;const P=g.put(_.result);P.onsuccess=function(){d(void 0)}}}})})}function ie({path:i,directory:o,blob:a,recursive:p}){return k.writeFile({directory:o,path:i,recursive:p,data:""}).then(function d(){if(a.size===0)return Promise.resolve();const l=384*1024,c=a.slice(0,l);return a=a.slice(l),new Response(c).arrayBuffer().then(function(s){return k.appendFile({directory:o,path:i,data:Oe(s)})}).then(d)})}function De(i){const{path:o,directory:a,blob:p,fast_mode:d=!1,recursive:l,on_fallback:c}=i;return!p||!Number.isSafeInteger(p.size)||typeof p.type!="string"?Promise.reject(new Error("Not a Blob.")):ye.getPlatform()==="web"?d?Ne(i):ie(i):Promise.all([Te.get_config(),k.getUri({path:o,directory:a})]).then(function([f,s]){const v=s.uri.replace("file://","");return(window.CapacitorWebFetch||window.fetch)(f.base_url+v+(l?"?recursive=true":""),{headers:{authorization:f.auth_token},method:"put",body:p}).then(function(m){if(m.status!==204)throw new Error("Bad HTTP status: "+m.status);return s.uri})}).catch(function(s){return c!==void 0&&c(s),ie(i)})}const Ce=Object.freeze(De);var W={},x,ae;function Le(){if(ae)return x;ae=1;function i(o){return o&&o.__esModule?o:{default:o}}return x=i,x}var H={exports:{}},se;function Ae(){return se||(se=1,(function(i){var o=(function(a){var p=Object.prototype,d=p.hasOwnProperty,l=Object.defineProperty||function(r,e,t){r[e]=t.value},c,f=typeof Symbol=="function"?Symbol:{},s=f.iterator||"@@iterator",v=f.asyncIterator||"@@asyncIterator",g=f.toStringTag||"@@toStringTag";function m(r,e,t){return Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),r[e]}try{m({},"")}catch{m=function(e,t,u){return e[t]=u}}function _(r,e,t,u){var n=e&&e.prototype instanceof U?e:U,h=Object.create(n.prototype),w=new $(u||[]);return l(h,"_invoke",{value:me(r,t,w)}),h}a.wrap=_;function P(r,e,t){try{return{type:"normal",arg:r.call(e,t)}}catch(u){return{type:"throw",arg:u}}}var K="suspendedStart",ge="suspendedYield",Z="executing",A="completed",b={};function U(){}function I(){}function O(){}var q={};m(q,s,function(){return this});var B=Object.getPrototypeOf,G=B&&B(B(Y([])));G&&G!==p&&d.call(G,s)&&(q=G);var D=O.prototype=U.prototype=Object.create(q);I.prototype=O,l(D,"constructor",{value:O,configurable:!0}),l(O,"constructor",{value:I,configurable:!0}),I.displayName=m(O,g,"GeneratorFunction");function ee(r){["next","throw","return"].forEach(function(e){m(r,e,function(t){return this._invoke(e,t)})})}a.isGeneratorFunction=function(r){var e=typeof r=="function"&&r.constructor;return e?e===I||(e.displayName||e.name)==="GeneratorFunction":!1},a.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,O):(r.__proto__=O,m(r,g,"GeneratorFunction")),r.prototype=Object.create(D),r},a.awrap=function(r){return{__await:r}};function M(r,e){function t(h,w,R,E){var y=P(r[h],r,w);if(y.type==="throw")E(y.arg);else{var z=y.arg,C=z.value;return C&&typeof C=="object"&&d.call(C,"__await")?e.resolve(C.__await).then(function(N){t("next",N,R,E)},function(N){t("throw",N,R,E)}):e.resolve(C).then(function(N){z.value=N,R(z)},function(N){return t("throw",N,R,E)})}}var u;function n(h,w){function R(){return new e(function(E,y){t(h,w,E,y)})}return u=u?u.then(R,R):R()}l(this,"_invoke",{value:n})}ee(M.prototype),m(M.prototype,v,function(){return this}),a.AsyncIterator=M,a.async=function(r,e,t,u,n){n===void 0&&(n=Promise);var h=new M(_(r,e,t,u),n);return a.isGeneratorFunction(e)?h:h.next().then(function(w){return w.done?w.value:h.next()})};function me(r,e,t){var u=K;return function(h,w){if(u===Z)throw new Error("Generator is already running");if(u===A){if(h==="throw")throw w;return te()}for(t.method=h,t.arg=w;;){var R=t.delegate;if(R){var E=re(R,t);if(E){if(E===b)continue;return E}}if(t.method==="next")t.sent=t._sent=t.arg;else if(t.method==="throw"){if(u===K)throw u=A,t.arg;t.dispatchException(t.arg)}else t.method==="return"&&t.abrupt("return",t.arg);u=Z;var y=P(r,e,t);if(y.type==="normal"){if(u=t.done?A:ge,y.arg===b)continue;return{value:y.arg,done:t.done}}else y.type==="throw"&&(u=A,t.method="throw",t.arg=y.arg)}}}function re(r,e){var t=e.method,u=r.iterator[t];if(u===c)return e.delegate=null,t==="throw"&&r.iterator.return&&(e.method="return",e.arg=c,re(r,e),e.method==="throw")||t!=="return"&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+t+"' method")),b;var n=P(u,r.iterator,e.arg);if(n.type==="throw")return e.method="throw",e.arg=n.arg,e.delegate=null,b;var h=n.arg;if(!h)return e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,b;if(h.done)e[r.resultName]=h.value,e.next=r.nextLoc,e.method!=="return"&&(e.method="next",e.arg=c);else return h;return e.delegate=null,b}ee(D),m(D,g,"Generator"),m(D,s,function(){return this}),m(D,"toString",function(){return"[object Generator]"});function we(r){var e={tryLoc:r[0]};1 in r&&(e.catchLoc=r[1]),2 in r&&(e.finallyLoc=r[2],e.afterLoc=r[3]),this.tryEntries.push(e)}function j(r){var e=r.completion||{};e.type="normal",delete e.arg,r.completion=e}function $(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(we,this),this.reset(!0)}a.keys=function(r){var e=Object(r),t=[];for(var u in e)t.push(u);return t.reverse(),function n(){for(;t.length;){var h=t.pop();if(h in e)return n.value=h,n.done=!1,n}return n.done=!0,n}};function Y(r){if(r){var e=r[s];if(e)return e.call(r);if(typeof r.next=="function")return r;if(!isNaN(r.length)){var t=-1,u=function n(){for(;++t<r.length;)if(d.call(r,t))return n.value=r[t],n.done=!1,n;return n.value=c,n.done=!0,n};return u.next=u}}return{next:te}}a.values=Y;function te(){return{value:c,done:!0}}return $.prototype={constructor:$,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(j),!r)for(var e in this)e.charAt(0)==="t"&&d.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=c)},stop:function(){this.done=!0;var r=this.tryEntries[0],e=r.completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function t(E,y){return h.type="throw",h.arg=r,e.next=E,y&&(e.method="next",e.arg=c),!!y}for(var u=this.tryEntries.length-1;u>=0;--u){var n=this.tryEntries[u],h=n.completion;if(n.tryLoc==="root")return t("end");if(n.tryLoc<=this.prev){var w=d.call(n,"catchLoc"),R=d.call(n,"finallyLoc");if(w&&R){if(this.prev<n.catchLoc)return t(n.catchLoc,!0);if(this.prev<n.finallyLoc)return t(n.finallyLoc)}else if(w){if(this.prev<n.catchLoc)return t(n.catchLoc,!0)}else if(R){if(this.prev<n.finallyLoc)return t(n.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(r,e){for(var t=this.tryEntries.length-1;t>=0;--t){var u=this.tryEntries[t];if(u.tryLoc<=this.prev&&d.call(u,"finallyLoc")&&this.prev<u.finallyLoc){var n=u;break}}n&&(r==="break"||r==="continue")&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var h=n?n.completion:{};return h.type=r,h.arg=e,n?(this.method="next",this.next=n.finallyLoc,b):this.complete(h)},complete:function(r,e){if(r.type==="throw")throw r.arg;return r.type==="break"||r.type==="continue"?this.next=r.arg:r.type==="return"?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):r.type==="normal"&&e&&(this.next=e),b},finish:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===r)return this.complete(t.completion,t.afterLoc),j(t),b}},catch:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===r){var u=t.completion;if(u.type==="throw"){var n=u.arg;j(t)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(r,e,t){return this.delegate={iterator:Y(r),resultName:e,nextLoc:t},this.method==="next"&&(this.arg=c),b}},a})(i.exports);try{regeneratorRuntime=o}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}})(H)),H.exports}var V,ue;function Ie(){return ue||(ue=1,V=Ae()),V}var X,ce;function Ge(){if(ce)return X;ce=1;function i(a,p,d,l,c,f,s){try{var v=a[f](s),g=v.value}catch(m){d(m);return}v.done?p(g):Promise.resolve(g).then(l,c)}function o(a){return function(){var p=this,d=arguments;return new Promise(function(l,c){var f=a.apply(p,d);function s(g){i(f,l,c,s,v,"next",g)}function v(g){i(f,l,c,s,v,"throw",g)}s(void 0)})}}return X=o,X}var de;function Me(){return de||(de=1,(function(i){var o=Le();Object.defineProperty(i,"__esModule",{value:!0}),i.default=d;var a=o(Ie()),p=o(Ge());function d(c){return l.apply(this,arguments)}function l(){return(l=(0,p.default)(a.default.mark(function c(f){var s,v;return a.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return s=document.createElement("video"),v=new Promise(function(m,_){s.addEventListener("loadedmetadata",function(){s.duration===1/0?(s.currentTime=Number.MAX_SAFE_INTEGER,s.ontimeupdate=function(){s.ontimeupdate=null,m(s.duration),s.currentTime=0}):m(s.duration)}),s.onerror=function(P){return _(P.target.error)}}),s.src=typeof f=="string"||f instanceof String?f:window.URL.createObjectURL(f),g.abrupt("return",v);case 4:case"end":return g.stop()}},c)}))).apply(this,arguments)}})(W)),W}var Fe=Me();const ke=Ee(Fe),T=()=>({value:!0}),L=()=>({value:!1}),Ue=()=>new Error("MISSING_PERMISSION"),qe=()=>new Error("ALREADY_RECORDING"),Be=()=>new Error("DEVICE_CANNOT_VOICE_RECORD"),le=()=>new Error("FAILED_TO_RECORD"),je=()=>new Error("EMPTY_RECORDING"),Q=()=>new Error("RECORDING_HAS_NOT_STARTED"),fe=()=>new Error("FAILED_TO_FETCH_RECORDING"),J=()=>new Error("COULD_NOT_QUERY_PERMISSION_STATUS"),he={"audio/aac":".aac","audio/mp4":".mp3","audio/webm;codecs=opus":".ogg","audio/webm":".ogg","audio/ogg;codecs=opus":".ogg"},pe=()=>new Promise(()=>{});class S{constructor(){this.mediaRecorder=null,this.chunks=[],this.pendingResult=pe()}static async canDeviceVoiceRecord(){var o;return((o=navigator?.mediaDevices)===null||o===void 0?void 0:o.getUserMedia)==null||S.getSupportedMimeType()==null?L():T()}async startRecording(o){if(this.mediaRecorder!=null)throw qe();if(!(await S.canDeviceVoiceRecord()).value)throw Be();if(!(await S.hasAudioRecordingPermission().catch(()=>T())).value)throw Ue();return navigator.mediaDevices.getUserMedia({audio:!0}).then(d=>this.onSuccessfullyStartedRecording(d,o)).catch(this.onFailedToStartRecording.bind(this))}async stopRecording(){if(this.mediaRecorder==null)throw Q();try{return this.mediaRecorder.stop(),this.mediaRecorder.stream.getTracks().forEach(o=>o.stop()),this.pendingResult}catch{throw fe()}finally{this.prepareInstanceForNextOperation()}}static async hasAudioRecordingPermission(){return navigator.permissions.query==null?navigator.mediaDevices==null?Promise.reject(J()):navigator.mediaDevices.getUserMedia({audio:!0}).then(()=>T()).catch(()=>{throw J()}):navigator.permissions.query({name:"microphone"}).then(o=>({value:o.state==="granted"})).catch(()=>{throw J()})}static async requestAudioRecordingPermission(){return(await S.hasAudioRecordingPermission().catch(()=>L())).value?T():navigator.mediaDevices.getUserMedia({audio:!0}).then(()=>T()).catch(()=>L())}pauseRecording(){if(this.mediaRecorder==null)throw Q();return this.mediaRecorder.state==="recording"?(this.mediaRecorder.pause(),Promise.resolve(T())):Promise.resolve(L())}resumeRecording(){if(this.mediaRecorder==null)throw Q();return this.mediaRecorder.state==="paused"?(this.mediaRecorder.resume(),Promise.resolve(T())):Promise.resolve(L())}getCurrentStatus(){return this.mediaRecorder==null?Promise.resolve({status:F.NONE}):this.mediaRecorder.state==="recording"?Promise.resolve({status:F.RECORDING}):this.mediaRecorder.state==="paused"?Promise.resolve({status:F.PAUSED}):Promise.resolve({status:F.NONE})}static getSupportedMimeType(){if(MediaRecorder?.isTypeSupported==null)return null;const o=Object.keys(he).find(a=>MediaRecorder.isTypeSupported(a));return o??null}onSuccessfullyStartedRecording(o,a){return this.pendingResult=new Promise((p,d)=>{this.mediaRecorder=new MediaRecorder(o),this.mediaRecorder.onerror=()=>{this.prepareInstanceForNextOperation(),d(le())},this.mediaRecorder.onstop=async()=>{var l,c,f;const s=S.getSupportedMimeType();if(s==null){this.prepareInstanceForNextOperation(),d(fe());return}const v=new Blob(this.chunks,{type:s});if(v.size<=0){this.prepareInstanceForNextOperation(),d(je());return}let g,m;a!=null?(g=`${(f=(c=(l=a.subDirectory)===null||l===void 0?void 0:l.match(/^\/?(.+[^/])\/?$/))===null||c===void 0?void 0:c[1])!==null&&f!==void 0?f:""}/recording-${new Date().getTime()}${he[s]}`,await Ce({blob:v,directory:a.directory,fast_mode:!0,path:g,recursive:!0})):m=await S.blobToBase64(v);const _=await ke(v);this.prepareInstanceForNextOperation(),p({value:{recordDataBase64:m,mimeType:s,msDuration:_*1e3,path:g}})},this.mediaRecorder.ondataavailable=l=>this.chunks.push(l.data),this.mediaRecorder.start()}),T()}onFailedToStartRecording(){throw this.prepareInstanceForNextOperation(),le()}static blobToBase64(o){return new Promise(a=>{const p=new FileReader;p.onloadend=()=>{const d=String(p.result),l=d.split("base64,"),c=l.length>1?l[1]:d;a(c.trim())},p.readAsDataURL(o)})}prepareInstanceForNextOperation(){if(this.mediaRecorder!=null&&this.mediaRecorder.state==="recording")try{this.mediaRecorder.stop()}catch(o){console.warn("While trying to stop a media recorder, an error was thrown",o)}this.pendingResult=pe(),this.mediaRecorder=null,this.chunks=[]}}class $e extends _e{constructor(){super(...arguments),this.voiceRecorderInstance=new S}canDeviceVoiceRecord(){return S.canDeviceVoiceRecord()}hasAudioRecordingPermission(){return S.hasAudioRecordingPermission()}requestAudioRecordingPermission(){return S.requestAudioRecordingPermission()}startRecording(o){return this.voiceRecorderInstance.startRecording(o)}stopRecording(){return this.voiceRecorderInstance.stopRecording()}pauseRecording(){return this.voiceRecorderInstance.pauseRecording()}resumeRecording(){return this.voiceRecorderInstance.resumeRecording()}getCurrentStatus(){return this.voiceRecorderInstance.getCurrentStatus()}}const ze=Object.freeze(Object.defineProperty({__proto__:null,VoiceRecorderWeb:$e},Symbol.toStringTag,{value:"Module"}));export{oe as E,ze as w};
